USE [$(dbName)]
Go

Declare @NotificationTypeId int
select @NotificationTypeId = NotificationTypeId from TblNotificationType where NotificationTypeNameAlias = 'CustomerWelcomeEmailWithPassword'

if not Exists (select EmailTemplateId from TblEmailTemplate where EmailTitle = 'CustomerWelcomeEmailWithPassword')
begin
	INSERT INTO [TblEmailTemplate]
			   ([EmailTitle],[EmailSubject],[EmailBody],[DateCreated],[DateModified],[TemplateType],[NotificationTypeId])
	VALUES
	('CustomerWelcomeEmailWithPassword','Customer Welcome Email' 
		,'<table style="border-collapse: collapse; border-color: black; width: 600px;" border="1" cellspacing="0" cellpadding="0">  <tbody>  <tr>  <td style="vertical-align: top;">  <table style="font-family: Arial; width: 600px;" border="0" cellspacing="0" cellpadding="2">  <tbody>  <tr>  <td style="height: 100px;">  <table style="width: 600px;" border="0" cellspacing="0" cellpadding="2">  <tbody>  <tr>  <td style="width: 250px;"><img src="@Model.EmailCommunicationBaseInfo.EmailNotificationLogoRelativePath" alt="" /></td>  </tr>  </tbody>  </table>  </td>  </tr>  <tr>  <td style="font-size: 13px;">  <p>Dear @Model.FullName,<br /> <br /> Thank you for registering for your @Model.EmailCommunicationBaseInfo.CompanyName Screening. You can access your appointment details and results through our secure and convenient online portal. The portal will allow you to access details about your appointment, print a copy of your receipt and view your screening results once they are complete.</p>  <p>You should have already received an email with your assigned username. To set the password for the first time you need to use the link given below .This link is for single time use</p>  <p> <a target="_blank" href="@Model.EmailCommunicationBaseInfo.AppUrl/App/ResetPassword.aspx?UserID=@Model.UserId&amp;AuthStr=@Model.ResetPasswordQueryString">@Model.EmailCommunicationBaseInfo.AppUrl/App/ResetPassword.aspx?UserID=@Model.UserId&amp;AuthStr=@Model.ResetPasswordQueryString</a>  </p>  <p><br /> <strong>Please use&nbsp; your assigned username (which you received in a separate email) to log in to @Model.EmailCommunicationBaseInfo.CompanyName <a href="@Model.EmailCommunicationBaseInfo.LoginUrl"> (@Model.EmailCommunicationBaseInfo.LoginUrl)</a> to access your account.</strong> <br /> <br /> If you ever need to contact us, we&rsquo;re just an email or a phone call away! You may contact us at <a href="mailto:@Model.EmailCommunicationBaseInfo.SupportEmail"> @Model.EmailCommunicationBaseInfo.SupportEmail</a> or @Model.EmailCommunicationBaseInfo.PhoneTollFree (Toll free).<br /> <br />- @Model.EmailCommunicationBaseInfo.CompanyName</p>  </td>  </tr>  <tr>  <td><hr style="border: 1px; color: black;" /></td>  </tr>  <tr>  <td style="font-size: 13px;">Reminder: @Model.EmailCommunicationBaseInfo.CompanyName will never ask for your password or credit card number in an email.<br /> <br /> This email was sent by @Model.EmailCommunicationBaseInfo.CompanyName because you or someone on your behalf registered online at <a href="@Model.EmailCommunicationBaseInfo.SiteUrl" target="_blank"> @Model.EmailCommunicationBaseInfo.SiteUrl.</a><br /> <br /> <strong>@Model.EmailCommunicationBaseInfo.CompanyName</strong><br /> @Model.EmailCommunicationBaseInfo.CompanyAddress.StreetAddressLine1<br /> @Model.EmailCommunicationBaseInfo.CompanyAddress.StreetAddressLine2<br /> @Model.EmailCommunicationBaseInfo.CompanyAddress.City, @Model.EmailCommunicationBaseInfo.CompanyAddress.State&nbsp; @Model.EmailCommunicationBaseInfo.CompanyAddress.ZipCode<br /> @Model.EmailCommunicationBaseInfo.PhoneTollFree (Toll free) <br /> &copy; @Model.EmailCommunicationBaseInfo.CopyrightText <a href="@Model.EmailCommunicationBaseInfo.PrivacyPolicyUrl" target="_blank"> Privacy Policy</a> | <a href="http://www.healthfair.com/cancellation-policy/" target="_blank"> Cancellation Policy</a><br /> <br /> <strong>THIS IS AN AUTOMATED MESSAGE</strong> - PLEASE DO NOT REPLY DIRECTLY TO THIS EMAIL. IF YOU WISH TO CONTACT HEALTHFAIR VIA EMAIL PLEASE USE <a href="mailto:INFO@HEALTHFAIR.COM"> INFO@HEALTHFAIR.COM</a></td>  </tr>  </tbody>  </table>  </td>  </tr>  </tbody>  </table>'
		,getDate(),getDate(),174,@NotificationTypeId)

end
else
begin
	update TblEmailTemplate 
	set [EmailBody] = '<table style="border-collapse: collapse; border-color: black; width: 600px;" border="1" cellspacing="0" cellpadding="0">  <tbody>  <tr>  <td style="vertical-align: top;">  <table style="font-family: Arial; width: 600px;" border="0" cellspacing="0" cellpadding="2">  <tbody>  <tr>  <td style="height: 100px;">  <table style="width: 600px;" border="0" cellspacing="0" cellpadding="2">  <tbody>  <tr>  <td style="width: 250px;"><img src="@Model.EmailCommunicationBaseInfo.EmailNotificationLogoRelativePath" alt="" /></td>  </tr>  </tbody>  </table>  </td>  </tr>  <tr>  <td style="font-size: 13px;">  <p>Dear @Model.FullName,<br /> <br /> Thank you for registering for your @Model.EmailCommunicationBaseInfo.CompanyName Screening. You can access your appointment details and results through our secure and convenient online portal. The portal will allow you to access details about your appointment, print a copy of your receipt and view your screening results once they are complete.</p>  <p>You should have already received an email with your assigned username. To set the password for the first time you need to use the link given below .This link is for single time use</p>  <p> <a target="_blank" href="@Model.EmailCommunicationBaseInfo.AppUrl/App/ResetPassword.aspx?UserID=@Model.UserId&amp;AuthStr=@Model.ResetPasswordQueryString">@Model.EmailCommunicationBaseInfo.AppUrl/App/ResetPassword.aspx?UserID=@Model.UserId&amp;AuthStr=@Model.ResetPasswordQueryString</a>  </p>  <p><br /> <strong>Please use&nbsp; your assigned username (which you received in a separate email) to log in to @Model.EmailCommunicationBaseInfo.CompanyName <a href="@Model.EmailCommunicationBaseInfo.LoginUrl"> (@Model.EmailCommunicationBaseInfo.LoginUrl)</a> to access your account.</strong> <br /> <br /> If you ever need to contact us, we&rsquo;re just an email or a phone call away! You may contact us at <a href="mailto:@Model.EmailCommunicationBaseInfo.SupportEmail"> @Model.EmailCommunicationBaseInfo.SupportEmail</a> or @Model.EmailCommunicationBaseInfo.PhoneTollFree (Toll free).<br /> <br />- @Model.EmailCommunicationBaseInfo.CompanyName</p>  </td>  </tr>  <tr>  <td><hr style="border: 1px; color: black;" /></td>  </tr>  <tr>  <td style="font-size: 13px;">Reminder: @Model.EmailCommunicationBaseInfo.CompanyName will never ask for your password or credit card number in an email.<br /> <br /> This email was sent by @Model.EmailCommunicationBaseInfo.CompanyName because you or someone on your behalf registered online at <a href="@Model.EmailCommunicationBaseInfo.SiteUrl" target="_blank"> @Model.EmailCommunicationBaseInfo.SiteUrl.</a><br /> <br /> <strong>@Model.EmailCommunicationBaseInfo.CompanyName</strong><br /> @Model.EmailCommunicationBaseInfo.CompanyAddress.StreetAddressLine1<br /> @Model.EmailCommunicationBaseInfo.CompanyAddress.StreetAddressLine2<br /> @Model.EmailCommunicationBaseInfo.CompanyAddress.City, @Model.EmailCommunicationBaseInfo.CompanyAddress.State&nbsp; @Model.EmailCommunicationBaseInfo.CompanyAddress.ZipCode<br /> @Model.EmailCommunicationBaseInfo.PhoneTollFree (Toll free) <br /> &copy; @Model.EmailCommunicationBaseInfo.CopyrightText <a href="@Model.EmailCommunicationBaseInfo.PrivacyPolicyUrl" target="_blank"> Privacy Policy</a> | <a href="http://www.healthfair.com/cancellation-policy/" target="_blank"> Cancellation Policy</a><br /> <br /> <strong>THIS IS AN AUTOMATED MESSAGE</strong> - PLEASE DO NOT REPLY DIRECTLY TO THIS EMAIL. IF YOU WISH TO CONTACT HEALTHFAIR VIA EMAIL PLEASE USE <a href="mailto:INFO@HEALTHFAIR.COM"> INFO@HEALTHFAIR.COM</a></td>  </tr>  </tbody>  </table>  </td>  </tr>  </tbody>  </table>'
	where EmailTitle = 'CustomerWelcomeEmailWithPassword'
end
